# æœ¬ç•ªãƒ»é–‹ç™ºç’°å¢ƒåŒä¸€ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰è¨­è¨ˆ

## ğŸ¯ è¨­è¨ˆæ–¹é‡

### 1. ç’°å¢ƒåˆ†é›¢æˆ¦ç•¥

- **ãƒãƒ¼ãƒˆãƒ™ãƒ¼ã‚¹åˆ†é›¢**: æœ¬ç•ª(8080)ã€é–‹ç™º(8081)
- **ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ™ãƒ¼ã‚¹åˆ†é›¢**: denzirou.jp(æœ¬ç•ª)ã€dev.denzirou.jp(é–‹ç™º)
- **Dockerã‚³ãƒ³ãƒ†ãƒŠå®Œå…¨åˆ†é›¢**: ç‹¬ç«‹ã—ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ãƒœãƒªãƒ¥ãƒ¼ãƒ 

### 2. ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·æ§‹æˆ

```nginx
# ãƒ¡ã‚¤ãƒ³Nginxè¨­å®š
server {
    listen 80;
    server_name denzirou.jp;
    location / {
        proxy_pass http://localhost:8080;  # æœ¬ç•ªç’°å¢ƒ
    }
}

server {
    listen 80;
    server_name dev.denzirou.jp;
    location / {
        proxy_pass http://localhost:8081;  # é–‹ç™ºç’°å¢ƒ
        # é–‹ç™ºç’°å¢ƒç”¨Basicèªè¨¼
        auth_basic "Development Environment";
        auth_basic_user_file /etc/nginx/.htpasswd_dev;
    }
}
```

### 3. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```text
/opt/denzirou-company-web/
â”œâ”€â”€ production/          # æœ¬ç•ªç’°å¢ƒ
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ .env.production
â”‚   â””â”€â”€ data/
â”œâ”€â”€ development/         # é–‹ç™ºç’°å¢ƒ  
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ .env.development
â”‚   â””â”€â”€ data/
â”œâ”€â”€ nginx/              # ãƒ¡ã‚¤ãƒ³ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·
â”‚   â”œâ”€â”€ nginx.conf
â”‚   â”œâ”€â”€ production.conf
â”‚   â”œâ”€â”€ development.conf
â”‚   â””â”€â”€ .htpasswd_dev
â””â”€â”€ scripts/            # ç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
    â”œâ”€â”€ deploy-prod.sh
    â”œâ”€â”€ deploy-dev.sh
    â””â”€â”€ switch-env.sh
```

## ğŸ”§ å®Ÿè£…ã®åˆ©ç‚¹

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- âœ… é–‹ç™ºç’°å¢ƒã«Basicèªè¨¼ã§ä¿è­·
- âœ… æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã¨é–‹ç™ºãƒ‡ãƒ¼ã‚¿ã®å®Œå…¨åˆ†é›¢
- âœ… ç‹¬ç«‹ã—ãŸDockerãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯

### é‹ç”¨æ€§

- âœ… ç‹¬ç«‹ã—ãŸãƒ‡ãƒ—ãƒ­ã‚¤ãŒå¯èƒ½
- âœ… é–‹ç™ºç’°å¢ƒã§æœ¬ç•ªåŒæ§˜ã®ãƒ†ã‚¹ãƒˆ
- âœ… ç°¡å˜ãªç’°å¢ƒåˆ‡ã‚Šæ›¿ãˆ
- âœ… å€‹åˆ¥ã®ãƒ­ã‚°ã¨ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

- âœ… ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ã®æœ€é©åŒ–
- âœ… å¿…è¦ã«å¿œã˜ã¦ç’°å¢ƒåœæ­¢å¯èƒ½
- âœ… ç‹¬ç«‹ã—ãŸã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³

## ğŸš€ ä»£æ›¿ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

### A. Git Branch ãƒ™ãƒ¼ã‚¹

- mainãƒ–ãƒ©ãƒ³ãƒ â†’ æœ¬ç•ªç’°å¢ƒ
- developãƒ–ãƒ©ãƒ³ãƒ â†’ é–‹ç™ºç’°å¢ƒ
- è‡ªå‹•CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

### B. Docker Compose Override

```yaml
# docker-compose.yml (ãƒ™ãƒ¼ã‚¹)
# docker-compose.override.yml (é–‹ç™ºç”¨)
# docker-compose.prod.yml (æœ¬ç•ªç”¨)
```

### C. Kubernetes (å°†æ¥æ‹¡å¼µ)

- Namespaceåˆ†é›¢
- Ingress Controller
- è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°

## ğŸ“‹ æ¨å¥¨å®Ÿè£…æ‰‹é †

1. **ç¾åœ¨ã®æœ¬ç•ªç’°å¢ƒã‚’ç§»è¡Œ** (production/é…ä¸‹)
2. **é–‹ç™ºç’°å¢ƒç”¨è¨­å®šä½œæˆ** (development/é…ä¸‹)  
3. **ãƒ¡ã‚¤ãƒ³Nginxè¨­å®š** (ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·)
4. **ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ‹¡å¼µ**
5. **DNSè¨­å®š** (dev.denzirou.jpã®è¿½åŠ )

## âš ï¸ æ³¨æ„ç‚¹

- **ãƒªã‚½ãƒ¼ã‚¹æ¶ˆè²»**: 2ã¤ã®ç’°å¢ƒãŒåŒæ™‚ç¨¼åƒ
- **ãƒãƒ¼ãƒˆç«¶åˆ**: é©åˆ‡ãªãƒãƒ¼ãƒˆç®¡ç†ãŒå¿…è¦
- **SSLè¨¼æ˜æ›¸**: é–‹ç™ºç’°å¢ƒç”¨ã®è¨¼æ˜æ›¸è¨­å®š
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: ç’°å¢ƒã”ã¨ã«ç‹¬ç«‹ã—ãŸãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦

## ğŸ¯ æœ€çµ‚çš„ãªæ§‹æˆã‚¤ãƒ¡ãƒ¼ã‚¸

```text
Internet
    â†“
Nginx (ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚­ã‚·)
    â”œâ”€â”€ denzirou.jp â†’ :8080 (æœ¬ç•ª)
    â””â”€â”€ dev.denzirou.jp â†’ :8081 (é–‹ç™º)
        â†“
Dockerç’°å¢ƒ (å„ç’°å¢ƒç‹¬ç«‹)
â”œâ”€â”€ Production Container
â””â”€â”€ Development Container
```
